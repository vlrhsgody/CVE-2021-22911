# CVE-2021-22911

### 요약

- Rocker.chat은 오픈소스 팀 채팅 플랫폼이다.
- Rocket Chat 3.12.1~3.13.2에서는 해당 getPasswordPolicy 방식이 NoSQL Injection 공격에 취약하며 인증/권한 부여가 필요하지 않음
- 비밀번호 재설정 토큰을 유출하여 일반 사용자 계정을 탈취하는 데 사용될 수 있음

### 환경 구성 및 실행

- wget https://github.com/vulhub/vulhub/tree/master/rocketchat/CVE-2021-22911
- `docker compose up -d`

### 취약점 재현 단계

1. 로그인 페이지에서 비밀번호를 재설정하면 서버가 데이터 베이스에 비밀번호 재설정 토큰을 생성함
2. NoSQL Injection을 사용하여 이 비밀번호 재설정 토큰을 노출시킬 수 있음
3. 비밀번호 재설정 토큰을 사용하여 사용자 비밀번호를 변경할 수 있음

### 익스플로잇 진행
![1](https://github.com/vlrhsgody/vulhub/assets/106510018/4c3d1725-1651-4404-9cfb-71f0954cd4cd)

- 비밀번호 재설정시 서버가 데이터 베이스에 비밀번호 재설정 토큰을 생성
    
![2](https://github.com/vlrhsgody/vulhub/assets/106510018/0b8f238e-1f56-4a35-a3c0-61cc9f3e131e)
    
- [CVE-2021-22911.py](http://CVE-2021-22911.py)를 통해 비밀번호 재설정 토큰을 추출함
    
    
    
- 비밀번호 재설정 토큰을 이용해 비밀번호 재설정 토큰을 추출할 수 있고 이를 통해 NoSQL Injection 가능함
